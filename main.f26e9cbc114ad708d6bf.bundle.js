/*! For license information please see main.f26e9cbc114ad708d6bf.bundle.js.LICENSE.txt */
(()=>{var e,t={40:(e,t,i)=>{"use strict";i(260);const a=JSON.parse('{"devil":"devil","devilOnStone":"devilOnStone","fireplace (1)":"fireplace (1)","fireplace (2)":"fireplace (2)","fireplace (3)":"fireplace (3)","fireplace (4)":"fireplace (4)","fireplace (5)":"fireplace (5)","fireplace (6)":"fireplace (6)","fireplace2 (1)":"fireplace2 (1)","fireplace2 (2)":"fireplace2 (2)","fireplace2 (3)":"fireplace2 (3)","fireplace2 (4)":"fireplace2 (4)","fireplace2 (5)":"fireplace2 (5)","fireplace2 (6)":"fireplace2 (6)","MainStone":"MainStone","stone":"stone","tile047":"tile047","torch (1)":"torch (1)","torch (2)":"torch (2)","torch (3)":"torch (3)","torch (4)":"torch (4)","torch (5)":"torch (5)","torch (6)":"torch (6)"}'),r=JSON.parse('{"axeboss":"axeboss","Barbarian":"Barbarian","DEVIL":"DEVIL","enemy":"enemy","enemy_no_shadow":"enemy_no_shadow","king_attack (1)":"king_attack (1)","king_attack (10)":"king_attack (10)","king_attack (11)":"king_attack (11)","king_attack (12)":"king_attack (12)","king_attack (13)":"king_attack (13)","king_attack (14)":"king_attack (14)","king_attack (15)":"king_attack (15)","king_attack (16)":"king_attack (16)","king_attack (17)":"king_attack (17)","king_attack (18)":"king_attack (18)","king_attack (19)":"king_attack (19)","king_attack (2)":"king_attack (2)","king_attack (20)":"king_attack (20)","king_attack (21)":"king_attack (21)","king_attack (22)":"king_attack (22)","king_attack (23)":"king_attack (23)","king_attack (24)":"king_attack (24)","king_attack (25)":"king_attack (25)","king_attack (26)":"king_attack (26)","king_attack (27)":"king_attack (27)","king_attack (28)":"king_attack (28)","king_attack (29)":"king_attack (29)","king_attack (3)":"king_attack (3)","king_attack (30)":"king_attack (30)","king_attack (4)":"king_attack (4)","king_attack (5)":"king_attack (5)","king_attack (6)":"king_attack (6)","king_attack (7)":"king_attack (7)","king_attack (8)":"king_attack (8)","king_attack (9)":"king_attack (9)","king_idle (1)":"king_idle (1)","king_idle (10)":"king_idle (10)","king_idle (11)":"king_idle (11)","king_idle (12)":"king_idle (12)","king_idle (13)":"king_idle (13)","king_idle (14)":"king_idle (14)","king_idle (15)":"king_idle (15)","king_idle (16)":"king_idle (16)","king_idle (17)":"king_idle (17)","king_idle (18)":"king_idle (18)","king_idle (2)":"king_idle (2)","king_idle (3)":"king_idle (3)","king_idle (4)":"king_idle (4)","king_idle (5)":"king_idle (5)","king_idle (6)":"king_idle (6)","king_idle (7)":"king_idle (7)","king_idle (8)":"king_idle (8)","king_idle (9)":"king_idle (9)","mage":"mage","necro_idle (1)":"necro_idle (1)","necro_idle (10)":"necro_idle (10)","necro_idle (11)":"necro_idle (11)","necro_idle (2)":"necro_idle (2)","necro_idle (3)":"necro_idle (3)","necro_idle (4)":"necro_idle (4)","necro_idle (5)":"necro_idle (5)","necro_idle (6)":"necro_idle (6)","necro_idle (7)":"necro_idle (7)","necro_idle (8)":"necro_idle (8)","necro_idle (9)":"necro_idle (9)","necro_move (1)":"necro_move (1)","necro_move (10)":"necro_move (10)","necro_move (11)":"necro_move (11)","necro_move (12)":"necro_move (12)","necro_move (13)":"necro_move (13)","necro_move (14)":"necro_move (14)","necro_move (15)":"necro_move (15)","necro_move (16)":"necro_move (16)","necro_move (17)":"necro_move (17)","necro_move (18)":"necro_move (18)","necro_move (19)":"necro_move (19)","necro_move (2)":"necro_move (2)","necro_move (20)":"necro_move (20)","necro_move (21)":"necro_move (21)","necro_move (22)":"necro_move (22)","necro_move (23)":"necro_move (23)","necro_move (24)":"necro_move (24)","necro_move (3)":"necro_move (3)","necro_move (4)":"necro_move (4)","necro_move (5)":"necro_move (5)","necro_move (6)":"necro_move (6)","necro_move (7)":"necro_move (7)","necro_move (8)":"necro_move (8)","necro_move (9)":"necro_move (9)","player — копия":"player — копия","player":"player","question":"question","Rogue":"Rogue","samurai_attack_1 (1)":"samurai_attack_1 (1)","samurai_attack_1 (2)":"samurai_attack_1 (2)","samurai_attack_1 (3)":"samurai_attack_1 (3)","samurai_attack_1 (4)":"samurai_attack_1 (4)","samurai_attack_2 (1)":"samurai_attack_2 (1)","samurai_attack_2 (2)":"samurai_attack_2 (2)","samurai_attack_2 (3)":"samurai_attack_2 (3)","samurai_attack_2 (4)":"samurai_attack_2 (4)","samurai_idle (1)":"samurai_idle (1)","samurai_idle (2)":"samurai_idle (2)","samurai_idle (3)":"samurai_idle (3)","samurai_idle (4)":"samurai_idle (4)","samurai_run (1)":"samurai_run (1)","samurai_run (2)":"samurai_run (2)","samurai_run (3)":"samurai_run (3)","samurai_run (4)":"samurai_run (4)","samurai_run (5)":"samurai_run (5)","samurai_run (6)":"samurai_run (6)","samurai_run (7)":"samurai_run (7)","samurai_run (8)":"samurai_run (8)","selection":"selection","warlock":"warlock"}'),n=JSON.parse('{"bgBtn":"bgBtn","skull":"skull","StatsBg":"StatsBg","StatsBg1":"StatsBg1"}'),s=JSON.parse('{"amount":"amount","area":"area","axe":"axe","bible":"bible","castSpeed":"castSpeed","damage":"damage","health":"health","knife":"knife","moveSpeed":"moveSpeed","saintWater":"saintWater"}'),o=JSON.parse('{"frame_0_delay-0":"frame_0_delay-0","frame_1_delay-0":"frame_1_delay-0","frame_2_delay-0":"frame_2_delay-0","frame_3_delay-0":"frame_3_delay-0","frame_4_delay-0":"frame_4_delay-0"}'),l=JSON.parse('{"10":"10","11":"11","12":"12","13":"13","14":"14","00":"00","01":"01","02":"02","03":"03","04":"04","05":"05","06":"06","07":"07","08":"08","09":"09","Bringer-of-Death_Walk_1":"Bringer-of-Death_Walk_1","Bringer-of-Death_Walk_2":"Bringer-of-Death_Walk_2","Bringer-of-Death_Walk_3":"Bringer-of-Death_Walk_3","Bringer-of-Death_Walk_4":"Bringer-of-Death_Walk_4","Bringer-of-Death_Walk_5":"Bringer-of-Death_Walk_5","Bringer-of-Death_Walk_6":"Bringer-of-Death_Walk_6","Bringer-of-Death_Walk_7":"Bringer-of-Death_Walk_7","Bringer-of-Death_Walk_8":"Bringer-of-Death_Walk_8","demon_cleave_1":"demon_cleave_1","demon_cleave_10":"demon_cleave_10","demon_cleave_11":"demon_cleave_11","demon_cleave_12":"demon_cleave_12","demon_cleave_13":"demon_cleave_13","demon_cleave_14":"demon_cleave_14","demon_cleave_15":"demon_cleave_15","demon_cleave_2":"demon_cleave_2","demon_cleave_3":"demon_cleave_3","demon_cleave_4":"demon_cleave_4","demon_cleave_5":"demon_cleave_5","demon_cleave_6":"demon_cleave_6","demon_cleave_7":"demon_cleave_7","demon_cleave_8":"demon_cleave_8","demon_cleave_9":"demon_cleave_9","demon_walk_1":"demon_walk_1","demon_walk_10":"demon_walk_10","demon_walk_11":"demon_walk_11","demon_walk_12":"demon_walk_12","demon_walk_2":"demon_walk_2","demon_walk_3":"demon_walk_3","demon_walk_4":"demon_walk_4","demon_walk_5":"demon_walk_5","demon_walk_6":"demon_walk_6","demon_walk_7":"demon_walk_7","demon_walk_8":"demon_walk_8","demon_walk_9":"demon_walk_9","eye (1)":"eye (1)","eye (2)":"eye (2)","eye (3)":"eye (3)","eye (4)":"eye (4)","eye (5)":"eye (5)","eye (6)":"eye (6)","eye (7)":"eye (7)","eye (8)":"eye (8)","goblin_attack (1)":"goblin_attack (1)","goblin_attack (2)":"goblin_attack (2)","goblin_attack (3)":"goblin_attack (3)","goblin_attack (4)":"goblin_attack (4)","goblin_attack (5)":"goblin_attack (5)","goblin_attack (6)":"goblin_attack (6)","goblin_attack (7)":"goblin_attack (7)","goblin_attack (8)":"goblin_attack (8)","goblin_walk (1)":"goblin_walk (1)","goblin_walk (2)":"goblin_walk (2)","goblin_walk (3)":"goblin_walk (3)","goblin_walk (4)":"goblin_walk (4)","goblin_walk (5)":"goblin_walk (5)","goblin_walk (6)":"goblin_walk (6)","goblin_walk (7)":"goblin_walk (7)","goblin_walk (8)":"goblin_walk (8)","mushroom-attack (1)":"mushroom-attack (1)","mushroom-attack (2)":"mushroom-attack (2)","mushroom-attack (3)":"mushroom-attack (3)","mushroom-attack (4)":"mushroom-attack (4)","mushroom-attack (5)":"mushroom-attack (5)","mushroom-attack (6)":"mushroom-attack (6)","mushroom-attack (7)":"mushroom-attack (7)","mushroom-attack (8)":"mushroom-attack (8)","mushroom-idle (1)":"mushroom-idle (1)","mushroom-idle (2)":"mushroom-idle (2)","mushroom-idle (3)":"mushroom-idle (3)","mushroom-idle (4)":"mushroom-idle (4)","mushroom_run (1)":"mushroom_run (1)","mushroom_run (2)":"mushroom_run (2)","mushroom_run (3)":"mushroom_run (3)","mushroom_run (4)":"mushroom_run (4)","mushroom_run (5)":"mushroom_run (5)","mushroom_run (6)":"mushroom_run (6)","mushroom_run (7)":"mushroom_run (7)","mushroom_run (8)":"mushroom_run (8)","rat (1)":"rat (1)","rat (2)":"rat (2)","rat (3)":"rat (3)","rat (4)":"rat (4)","rat (5)":"rat (5)","rat (6)":"rat (6)","red_hood_idle (1)":"red_hood_idle (1)","red_hood_idle (10)":"red_hood_idle (10)","red_hood_idle (11)":"red_hood_idle (11)","red_hood_idle (12)":"red_hood_idle (12)","red_hood_idle (13)":"red_hood_idle (13)","red_hood_idle (14)":"red_hood_idle (14)","red_hood_idle (15)":"red_hood_idle (15)","red_hood_idle (16)":"red_hood_idle (16)","red_hood_idle (17)":"red_hood_idle (17)","red_hood_idle (18)":"red_hood_idle (18)","red_hood_idle (2)":"red_hood_idle (2)","red_hood_idle (3)":"red_hood_idle (3)","red_hood_idle (4)":"red_hood_idle (4)","red_hood_idle (5)":"red_hood_idle (5)","red_hood_idle (6)":"red_hood_idle (6)","red_hood_idle (7)":"red_hood_idle (7)","red_hood_idle (8)":"red_hood_idle (8)","red_hood_idle (9)":"red_hood_idle (9)","skeleton (1)":"skeleton (1)","skeleton (2)":"skeleton (2)","skeleton (3)":"skeleton (3)","skeleton (4)":"skeleton (4)","slime-attack-0":"slime-attack-0","slime-attack-1":"slime-attack-1","slime-attack-2":"slime-attack-2","slime-attack-3":"slime-attack-3","slime-attack-4":"slime-attack-4","slime-die-0":"slime-die-0","slime-die-1":"slime-die-1","slime-die-2":"slime-die-2","slime-die-3":"slime-die-3","slime-hurt-0":"slime-hurt-0","slime-hurt-1":"slime-hurt-1","slime-hurt-2":"slime-hurt-2","slime-hurt-3":"slime-hurt-3","slime-idle-0":"slime-idle-0","slime-idle-1":"slime-idle-1","slime-idle-2":"slime-idle-2","slime-idle-3":"slime-idle-3","slime-move-0":"slime-move-0","slime-move-1":"slime-move-1","slime-move-2":"slime-move-2","slime-move-3":"slime-move-3","tile001":"tile001","tile002":"tile002","tile003":"tile003","tile004":"tile004","tile005":"tile005","tile006":"tile006","tile007":"tile007","tile008":"tile008","tile009":"tile009","tile010":"tile010","tile011":"tile011","tile012":"tile012","tile013":"tile013","tile014":"tile014","tile015":"tile015","tile016":"tile016","tile017":"tile017","tile018":"tile018","tile019":"tile019","tile020":"tile020","tile021":"tile021","tile022":"tile022","tile023":"tile023","tile024":"tile024","tile056":"tile056","tile057":"tile057","tile058":"tile058","tile059":"tile059","tile060":"tile060","tile061":"tile061","tile062":"tile062","tile063":"tile063","tile064":"tile064","tile065":"tile065","tile066":"tile066","tile067":"tile067","tile068":"tile068","tile069":"tile069","tile070":"tile070","tile071":"tile071","tile072":"tile072","tile073":"tile073","tile074":"tile074","tile075":"tile075","tile076":"tile076","tile077":"tile077","tile078":"tile078","tile079":"tile079","tile080":"tile080","tile081":"tile081","tile082":"tile082","tile083":"tile083","tile084":"tile084","tile085":"tile085","tile086":"tile086","tile087":"tile087","tile088":"tile088","tile089":"tile089","tile090":"tile090","tile091":"tile091","tile092":"tile092","tile093":"tile093","tile094":"tile094","tile095":"tile095","tile096":"tile096","tile097":"tile097","tile098":"tile098","tile099":"tile099","tile100":"tile100","tile101":"tile101","tile102":"tile102","tile103":"tile103","tile104":"tile104","tile105":"tile105","tile106":"tile106","tile107":"tile107","tile108":"tile108","tile109":"tile109","tile110":"tile110","tile111":"tile111","tile112":"tile112","tile113":"tile113","tile114":"tile114","tile115":"tile115","tile116":"tile116","tile117":"tile117","tile118":"tile118","tile119":"tile119","tile120":"tile120","tree_walk (1)":"tree_walk (1)","tree_walk (2)":"tree_walk (2)","tree_walk (3)":"tree_walk (3)","tree_walk (4)":"tree_walk (4)","tree_walk (5)":"tree_walk (5)","tree_walk (6)":"tree_walk (6)","tree_walk (7)":"tree_walk (7)","walk_1":"walk_1","walk_2":"walk_2","walk_3":"walk_3","walk_4":"walk_4","walk_5":"walk_5","walk_6":"walk_6","whiteWolfAttack (1)":"whiteWolfAttack (1)","whiteWolfAttack (2)":"whiteWolfAttack (2)","whiteWolfAttack (3)":"whiteWolfAttack (3)","whiteWolfAttack (4)":"whiteWolfAttack (4)","whiteWolfAttack (5)":"whiteWolfAttack (5)","whiteWolfAttack (6)":"whiteWolfAttack (6)","whiteWolfAttack (7)":"whiteWolfAttack (7)","whiteWolfIdle (1)":"whiteWolfIdle (1)","whiteWolfIdle (2)":"whiteWolfIdle (2)","whiteWolfIdle (3)":"whiteWolfIdle (3)","whiteWolfIdle (4)":"whiteWolfIdle (4)","whiteWolfMove (1)":"whiteWolfMove (1)","whiteWolfMove (2)":"whiteWolfMove (2)","whiteWolfMove (3)":"whiteWolfMove (3)","whiteWolfMove (4)":"whiteWolfMove (4)","whiteWolfMove (5)":"whiteWolfMove (5)","whiteWolfMove (6)":"whiteWolfMove (6)"}'),c=JSON.parse('{"0":"0","1":"1","2":"2","3":"3","4":"4","5":"5","6":"6","7":"7"}'),h=JSON.parse('{"0":"0","1":"1","2":"2","3":"3","4":"4","5":"5","6":"6","7":"7","frame0000":"frame0000","frame0001":"frame0001","frame0002":"frame0002","frame0003":"frame0003","frame0004":"frame0004","frame0005":"frame0005","frame0006":"frame0006","frame0007":"frame0007","frame0008":"frame0008","frame0009":"frame0009","frame0010":"frame0010","frame0011":"frame0011","frame0012":"frame0012","frame0013":"frame0013","frame0014":"frame0014","frame0015":"frame0015","frame0016":"frame0016","frame0017":"frame0017","frame0018":"frame0018","frame0019":"frame0019","frame0020":"frame0020","frame0021":"frame0021","frame0022":"frame0022","frame0023":"frame0023","frame0024":"frame0024","frame0025":"frame0025","frame0026":"frame0026","frame0027":"frame0027","frame0028":"frame0028","frame0029":"frame0029","frame0030":"frame0030","frame0031":"frame0031","frame0032":"frame0032","frame0033":"frame0033","frame0034":"frame0034","frame0035":"frame0035","frame0036":"frame0036","frame0037":"frame0037","frame0038":"frame0038","frame0039":"frame0039","frame0040":"frame0040","frame0041":"frame0041","frame0042":"frame0042","frame0043":"frame0043","frame0044":"frame0044","frame0045":"frame0045","frame0046":"frame0046","frame0047":"frame0047","frame0048":"frame0048","frame0049":"frame0049","frame0050":"frame0050","frame0051":"frame0051","frame0052":"frame0052","frame0053":"frame0053","frame0054":"frame0054","frame0055":"frame0055","frame0056":"frame0056","frame0057":"frame0057","frame0058":"frame0058","frame0059":"frame0059","frame0060":"frame0060","frame0061":"frame0061","frame0062":"frame0062","frame0063":"frame0063","frame0064":"frame0064"}'),d=JSON.parse('{"air chubriks patron":"air chubriks patron","air_chubrik (1)":"air_chubrik (1)","air_chubrik (2)":"air_chubrik (2)","air_chubrik (3)":"air_chubrik (3)","air_chubrik (4)":"air_chubrik (4)","air_chubrik":"air_chubrik","air_chubrik_patron (1)":"air_chubrik_patron (1)","air_chubrik_patron (2)":"air_chubrik_patron (2)","air_chubrik_patron (3)":"air_chubrik_patron (3)","air_chubrik_patron (4)":"air_chubrik_patron (4)","air_chubrik_patron (5)":"air_chubrik_patron (5)","air_hero":"air_hero","air_hero1":"air_hero1","air_mage (1)":"air_mage (1)","air_mage (2)":"air_mage (2)","air_mage (3)":"air_mage (3)","air_mage (4)":"air_mage (4)","Air_mage":"Air_mage","bird (1)":"bird (1)","bird (2)":"bird (2)","bird (3)":"bird (3)","bird (4)":"bird (4)","bird":"bird","blood":"blood","chertik (1)":"chertik (1)","chertik (2)":"chertik (2)","chertik (3)":"chertik (3)","chertik (4)":"chertik (4)","chertik":"chertik","chubrik1":"chubrik1","chubrik2":"chubrik2","coin":"coin","cross":"cross","dragon (1)":"dragon (1)","dragon (2)":"dragon (2)","dragon (3)":"dragon (3)","dragon (4)":"dragon (4)","dragon":"dragon","earth1":"earth1","earth_bender (1)":"earth_bender (1)","earth_bender (2)":"earth_bender (2)","earth_bender (3)":"earth_bender (3)","earth_bender (4)":"earth_bender (4)","earth_chubrik (1)":"earth_chubrik (1)","earth_chubrik (2)":"earth_chubrik (2)","earth_chubrik (3)":"earth_chubrik (3)","earth_chubrik (4)":"earth_chubrik (4)","earth_chubrik":"earth_chubrik","earth_chubrik_body":"earth_chubrik_body","fire_chubrik (1)":"fire_chubrik (1)","fire_chubrik (2)":"fire_chubrik (2)","fire_chubrik (3)":"fire_chubrik (3)","fire_chubrik (4)":"fire_chubrik (4)","fire_chubrik_patron (1)":"fire_chubrik_patron (1)","fire_chubrik_patron (2)":"fire_chubrik_patron (2)","fire_chubrik_patron (3)":"fire_chubrik_patron (3)","fire_chubrik_patron (4)":"fire_chubrik_patron (4)","fire_chubrik_patron (5)":"fire_chubrik_patron (5)","fire_chubrik_patron":"fire_chubrik_patron","fire_hero":"fire_hero","grass1":"grass1","grass2":"grass2","grass3":"grass3","grass4":"grass4","lightning (1)":"lightning (1)","lightning (10)":"lightning (10)","lightning (11)":"lightning (11)","lightning (2)":"lightning (2)","lightning (3)":"lightning (3)","lightning (4)":"lightning (4)","lightning (5)":"lightning (5)","lightning (6)":"lightning (6)","lightning (7)":"lightning (7)","lightning (8)":"lightning (8)","lightning (9)":"lightning (9)","lightning":"lightning","luzha":"luzha","particle":"particle","particle1":"particle1","particle2":"particle2","pb_back":"pb_back","pb_handle":"pb_handle","photo_2023-07-27_02-40-45":"photo_2023-07-27_02-40-45","skeleton (1)":"skeleton (1)","skeleton (2)":"skeleton (2)","skeleton (3)":"skeleton (3)","skeleton (4)":"skeleton (4)","skeleton":"skeleton","spellbook":"spellbook","stone":"stone","water_chubrik (1)":"water_chubrik (1)","water_chubrik (2)":"water_chubrik (2)","water_chubrik (3)":"water_chubrik (3)","water_chubrik (4)":"water_chubrik (4)","water_chubrik_body":"water_chubrik_body","water_dragon (1)":"water_dragon (1)","water_dragon (2)":"water_dragon (2)","water_dragon (3)":"water_dragon (3)","water_dragon (4)":"water_dragon (4)","water_dragon":"water_dragon"}'),m={lightmap:"assets/img/lightmap.png",lightBg:"assets/img/lightBg.png",circ:"assets/img/circ.png",particle:"assets/img/particle.png",particle1:"assets/img/particle1.png",particle2:"assets/img/particle2.png"},_={Main:{image:"Main/texture.png",json:"Main/texture.json"}},u={S1:"assets/audio/s1.mp3"},g={Chubriks:"assets/jsons/Chubriks.json"},k=p(m),f=p(_);function p(e){const t={};return Object.entries(e).forEach((e=>{t[e[0]]=e[0]})),t}p(u),p(g),Object.assign({Key:f.Environment},a),Object.assign({Key:f.Characters},r),Object.assign({Key:f.UI},n),Object.assign({Key:f.Skills},s),Object.assign({Key:f.Animations},o),Object.assign({Key:f.Enemies},l),Object.assign({Key:f.Food},c),Object.assign({Key:f.Effects},h);const b=Object.assign({Key:f.Main},d);var y=function(e,t,i,a){return new(i||(i=Promise))((function(r,n){function s(e){try{l(a.next(e))}catch(e){n(e)}}function o(e){try{l(a.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,o)}l((a=a.apply(e,t||[])).next())}))};class w extends Phaser.Scene{get camera(){return this.cameras.main}get gameWidth(){return this&&this.game&&this.game.scale?this.game.scale.width:0}get gameHeight(){return this&&this.game&&this.game.scale?this.game.scale.height:0}constructor(e){super(e),this.evCache=[]}initResize(){this.camera.centerOn(0,0),this.events.once(Phaser.Scenes.Events.SHUTDOWN,(()=>{this.scale.off("resize")})),this.scale.on("resize",this.onResize,this),this.onResize()}onResize(){}initCameraMovement(){let e=!1;this.input.on("pointerdown",(t=>{t.middleButtonDown()&&(this.evCache.length>=2||(e=!0))})),this.input.on("pointermove",(()=>{if(this.evCache.length>=2)return;if(!e)return;let t=this.input.activePointer.position.x-this.input.activePointer.prevPosition.x,i=this.input.activePointer.position.y-this.input.activePointer.prevPosition.y;t*=.01*this.game.loop.delta*5,i*=.01*this.game.loop.delta*5;let a=this.camera.scrollX-t,r=this.camera.scrollY-i;this.camera.setScroll(a,r)})),this.input.on("pointerup",(t=>{t.middleButtonReleased()&&(this.evCache.length>=2||(e=!1))})),this.input.on(Phaser.Input.Events.GAME_OUT,(()=>{e=!1}))}initCameraZoom(e=.001){this.input.on("wheel",(t=>{this.cameras.main.zoom-=t.deltaY*e}))}enableDragDebug(){this.input.on("drag",(function(e,t,i,a){t.x=i,t.y=a})),this.events.on(Phaser.Scenes.Events.ADDED_TO_SCENE,(e=>{if(e instanceof Phaser.GameObjects.Sprite)try{e.setInteractive({useHandCursor:!1}).on("pointerup",(()=>{window.obj=e})),this.input.setDraggable(e,!0)}catch(e){console.error(e)}}))}enableContextDebug(){function e(){document.getElementById("contextMenu").style.display="none"}let t;document.onclick=e,document.oncontextmenu=function(i){if(i.preventDefault(),t)if("block"==document.getElementById("contextMenu").style.display)e();else{var a=document.getElementById("contextMenu");a.style.display="block",a.style.left=i.pageX+"px",a.style.top=i.pageY+"px"}},document.getElementsByClassName("Scale")[0].addEventListener("click",(()=>{var e;const i=parseFloat(null!==(e=prompt("Enter value"))&&void 0!==e?e:"1");null==t||t.setScale(i)})),document.getElementsByClassName("Flip")[0].addEventListener("click",(()=>{console.log("clickedobj flip: ",null==t?void 0:t.flipX),null==t||t.setFlipX(!t.flipX)})),document.getElementsByClassName("Destroy")[0].addEventListener("click",(()=>{null==t||t.destroy()})),this.events.on(Phaser.Scenes.Events.ADDED_TO_SCENE,(e=>{if(e instanceof Phaser.GameObjects.Sprite)try{let i;e.setInteractive({useHandCursor:!1}).on("pointerup",(a=>{a.rightButtonReleased()&&(console.log("rmb"),null==i||i.destroy(),null==t||t.setTintFill(16777215),this.time.delayedCall(175,(()=>null==t?void 0:t.clearTint())),t=e,console.log("clickedobj: ",t)),window.obj=e})).on("pointerout",(()=>{console.log("out"),t=void 0})),this.input.setDraggable(e,!0)}catch(e){console.error(e)}}))}show(e=250){return new Promise((t=>{this.camera.setAlpha(0),this.tweens.add({targets:this.camera,alpha:1,duration:e,ease:"Linear",onComplete:()=>{t()}})}))}hide(e,t=500){return y(this,void 0,void 0,(function*(){if(this)return this.scene.isPaused()&&this.scene.resume(),new Promise((i=>{this.tweens.add({targets:this.camera,alpha:0,duration:t,ease:"Quint",onComplete:()=>{null==e||e(),i()}})}))}))}get view(){if(this&&this.cameras&&this.cameras.main){const e=this.cameras.main,t=e.scrollY+e.centerY,i=e.scrollX+e.centerX,a=e.centerY/e.zoomY,r=e.centerX/e.zoomX,n=t-a,s=t+a,o=i-r,l=i+r;return new Phaser.Geom.Rectangle(o,n,l-o,s-n)}return new Phaser.Geom.Rectangle(0,0,0,0)}waitFor(e){return y(this,void 0,void 0,(function*(){return new Promise((t=>{this.time.delayedCall(e,(()=>{t()}))}))}))}getBounds(){if(this&&this.cameras&&this.cameras.main){const e=this.cameras.main,t=e.scrollY+e.centerY,i=e.scrollX+e.centerX,a=e.centerY/e.zoomY,r=e.centerX/e.zoomX,n=t-a,s=t+a,o=i-r,l=i+r;return new Phaser.Geom.Rectangle(o,n,l-o,s-n)}return new Phaser.Geom.Rectangle(0,0,0,0)}}function v(e){const t=e;return t.on("pointerdown",(()=>t.setData("pointerdown",!0))),t.on("pointerout",(()=>t.setData("pointerdown",!1))),t.on("pointerup",(()=>{!0===t.getData("pointerdown")&&(t.setData("pointerdown",!1),t.emit("click"))})),t}function x(e){var t,i,a,r;const n=e.parentContainer;if(!n)return null!==(i=null===(t=null==e?void 0:e.getBounds)||void 0===t?void 0:t.call(e))&&void 0!==i?i:null==e?void 0:e.getTextBounds().local;const s=n.getIndex(e);n.removeAt(s);const o=null!==(r=null===(a=null==e?void 0:e.getBounds)||void 0===a?void 0:a.call(e))&&void 0!==r?r:null==e?void 0:e.getTextBounds().local;return n.addAt(e,s),o}const S={AsColumn:(e,t,i=0,a=0)=>{if(0===e.length)return[];if(1===(e=e.filter((e=>void 0!==e))).length)return e[0].setPosition(i,a),[];let r=0;const n=[],s=[],o=[];t instanceof Array||(t=[t]);for(let i=0;i<e.length;i++){const a=e[i],l=x(a),c=l.height,h=a.y-l.centerY;n.push(c),s.push(l),o.push(h),r+=c,0!==i&&(r+=t[(i-1)%t.length]),a.setPosition(0,0)}let l=a-.5*r;for(let a=0;a<e.length;a++){const r=e[a],s=.5*n[a],c=0!==a?t[(a-1)%t.length]:0,h=o[a];r.y=l+s+c+h,r.x=i,l=r.y+s-h}return e},AsRow:(e,t,i=0,a=0)=>{if(0===e.length)return e;if(1===(e=e.filter((e=>void 0!==e))).length)return e[0].setPosition(i,a),e;let r=0;const n=[],s=[],o=[];t instanceof Array||(t=[t]);for(let i=0;i<e.length;i++){const a=e[i],l=x(a),c=l.width,h=a.x-l.centerX;n.push(c),s.push(l),o.push(h),r+=c,0!==i&&(r+=t[(i-1)%t.length]),a.setPosition(0,0)}let l=i-.5*r;for(let i=0;i<e.length;i++){const r=e[i],s=.5*n[i],c=0!==i?t[(i-1)%t.length]:0,h=o[i];r.y=a,r.x=l+s+c+h,l=r.x+s-h}return e},CenterAt(e,t,i){if(0===e.length)return;if(1===(e=e.filter((e=>void 0!==e))).length)return void e[0].setPosition(t,i);const a=new Phaser.Geom.Rectangle;e instanceof Phaser.GameObjects.Container&&function(e){const t=e.list,i=e.getBounds(),a=e.x-i.centerX,r=e.y-i.centerY;t.forEach((e=>{"Zone"!==e.type&&e.setPosition(e.x+a,e.y+r)}))}(e),e.forEach((e=>Phaser.Geom.Rectangle.MergeRect(a,e.getBounds())));const r=t-a.centerX,n=i-a.centerY;e.forEach((e=>e.setPosition(e.x+r,e.y+n)))},AsGrid(e,t,i,a,r=a,n){var s,o,l,c;if(0===e.length)return;if(1===(e=e.filter((e=>void 0!==e))).length)return void e[0].setPosition(0,0);const h=e[0].getBounds(),d=void 0!==h.size?h.size.x:h.width,m=void 0!==h.size?h.size.y:h.height,_=d+r,u=m+a;let g=e[0].x,k=e[0].y;const f=g;for(let a=0;a<t;a++){g=f;for(let t=0;t<i;t++){const r=e[a*i+t];null!=r&&(r.x=g,r.y=k),g+=_,null!=n&&null!=n.eachCol&&n.eachCol%t==0&&(g+=null!==(s=n.colOffsetX)&&void 0!==s?s:0,k+=null!==(o=n.colOffsetY)&&void 0!==o?o:0)}k+=u,null!=n&&null!=n.eachRow&&n.eachRow%a==0&&(g+=null!==(l=n.rowOffsetX)&&void 0!==l?l:0,k+=null!==(c=n.rowOffsetY)&&void 0!==c?c:0)}e.forEach((e=>{e.x-=_*(i-1)*.5,e.y-=u*(t-1)*.5}))}};function A(e,t){return i=this,a=void 0,n=function*(){return new Promise((i=>{if(null==e)return void i(void 0);const a=e.tweens.add(Object.assign(Object.assign({},t),{onComplete:e=>{e.remove(),t.onComplete&&(t.onCompleteScope?t.onComplete.bind(t.onCompleteScope)(a,t.targets,t.onCompleteParams):t.onComplete(a,t.targets,t.onCompleteParams)),i(a)}}))}))},new((r=void 0)||(r=Promise))((function(e,t){function s(e){try{l(n.next(e))}catch(e){t(e)}}function o(e){try{l(n.throw(e))}catch(e){t(e)}}function l(t){var i;t.done?e(t.value):(i=t.value,i instanceof r?i:new r((function(e){e(i)}))).then(s,o)}l((n=n.apply(i,a||[])).next())}));var i,a,r,n}var P=function(e,t,i,a){return new(i||(i=Promise))((function(r,n){function s(e){try{l(a.next(e))}catch(e){n(e)}}function o(e){try{l(a.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,o)}l((a=a.apply(e,t||[])).next())}))};class C{get x(){return this.sprite.x}get y(){return this.sprite.y}get type(){return this.config.type}constructor(e,t,i,a,r=Phaser.Math.Between(1,50)){this.rangeArray=[],this.scene=e,this.config=a,this.life=a.life,this.attack=a.attack,this.speed=a.speed,this.range=a.range,this.defense=a.defense,this.price=a.price,this.amount=r,this.sprite=C.createSprite(e,a.type).copyPosition(e.getWorldPosition(t,i)),this.amountText=e.add.bitmapText(0,0,"nokia16").setOrigin(.5).setCenterAlign().setDepth(15).setFontSize(11).setTint(1776411),this.updateAmountText(),this.sprite.setFlipX(t>0)}static createSprite(e,t){const i=C.getFrame(t);return e.add.sprite(0,0,b.Key,i).setScale(this.getScale(t)).setDepth(1).play(this.getAnim(t))}updateAmountText(){this.amountText.setPosition(this.x,this.y+.36*this.sprite.displayHeight).setText(this.amount.toString())}moveAction(e){return P(this,void 0,void 0,(function*(){this.clearRange(),this.sprite.setFlipX(e.x-this.x<0);const t=this.scene.tweens.add({targets:this.sprite,scaleY:"*=1.1",scaleX:"*=0.9",yoyo:!0,repeat:-1,duration:100,ease:"Sine.easeIn"});yield A(this.scene,{targets:[this.sprite],x:e.x,y:e.y,duration:500,onUpdate:()=>this.updateAmountText()}),t.remove()}))}attackAction(e){return P(this,void 0,void 0,(function*(){if(this.range>1)this.clearRange(),this.sprite.setFlipX(e.x-this.x<0),yield this.rangeAttackAction(this,e),this.scene.onMoveEnd();else{const t=this.scene.getLogicPosition(this.x,this.y),i=this.scene.getLogicPosition(e.x,e.y),a=[[1,0],[1,1],[0,1],[-1,1],[-1,0],[-1,-1],[0,-1],[1,-1]].map((e=>({col:i.col+e[0],row:i.row+e[1]}))).filter((e=>{const i=this.scene.isRangeValid(t.col,t.row,e.col,e.row),a=this.scene.getChubrik(e.col,e.row);return console.log(e,i,a),this.scene.isValid(e.col,e.row)&&(!a||a==this)&&i}));console.log(a);const r=a.map((e=>{const t=this.scene.getWorldPosition(e.col,e.row);return new Phaser.Math.Vector2(t.x-this.x,t.y-this.y).length()}));console.log(r);const n=Math.min(...r),s=r.indexOf(n);console.log(s);const o=a[s];if(o){const t=this.scene.getWorldPosition(o.col,o.row);this.clearRange(),this.sprite.setFlipX(e.x-this.x<0),t.x==this.x&&t.y==this.y||(yield this.scene.currentChubrik.moveAction(t),yield this.scene.waitFor(100)),yield this.meleeAttackAction(this,e),this.scene.onMoveEnd()}}}))}meleeAttackAction(e,t){return P(this,void 0,void 0,(function*(){const i=new Phaser.Math.Vector2(t.x-e.x,t.y-e.y).normalize();yield Promise.all([A(this.scene,{targets:[this.sprite],x:"+="+i.x*this.scene.cellSize*.5,y:"+="+i.y*this.scene.cellSize*.5,delay:150,duration:150,ease:"Ease.Sine.InOut",yoyo:!0,onUpdate:()=>this.updateAmountText()}),(()=>P(this,void 0,void 0,(function*(){yield this.scene.waitFor(300);const e=Phaser.Math.Clamp(this.attack-t.defense,0,Number.MAX_VALUE);yield t.takeDamage(e)})))()])}))}rangeAttackAction(e,t){return P(this,void 0,void 0,(function*(){const i=new Phaser.Math.Vector2(t.x-e.x,t.y-e.y).normalize();yield Promise.all([A(this.scene,{targets:[this.sprite],x:"+="+i.x*this.scene.cellSize*.5,y:"+="+i.y*this.scene.cellSize*.5,delay:150,duration:150,ease:"Ease.Sine.InOut",yoyo:!0,onUpdate:()=>this.updateAmountText()}),(()=>P(this,void 0,void 0,(function*(){yield this.scene.waitFor(300),yield this.projectile(t.x,t.y);const e=this.attack*this.amount-t.defense*this.amount;yield t.takeDamage(e)})))()])}))}projectile(e,t){return P(this,void 0,void 0,(function*(){const i="fire_chubrik"===this.config.type?"fire_chubrik_patron":"air_chubrik_patron",a=this.scene.add.sprite(this.x,this.y,b.Key,b["air_chubrik_patron (1)"]).play(i).setScale(.25).setDepth(2);yield A(this.scene,{targets:a,x:e,y:t,duration:500}),a.destroy()}))}takeDamage(e){return P(this,void 0,void 0,(function*(){this.sprite.setTintFill(16777215),this.scene.time.delayedCall(100,(()=>this.sprite.clearTint())),this.scene.bloodParticle.explode(10,this.x,this.y);const t=this.amount;for(;e>0&&(this.life-=e,!(this.life<=0&&(e=Math.abs(this.life),this.life=this.config.life,this.amount--,this.amount<=0))););const i=this.scene.add.bitmapText(this.x,this.y,"nokia16","-"+(t-this.amount)).setOrigin(.5).setCenterAlign().setDepth(20);this.scene.add.tween({targets:i,y:`-=${this.scene.cellSize}`,alpha:0}),this.updateAmountText(),this.amount<=0?yield this.die():yield A(this.scene,{targets:[this.sprite,this.amountText],scale:"*=1.25",ease:"Sine.Ease.In",yoyo:!0,duration:150})}))}die(){return P(this,void 0,void 0,(function*(){yield A(this.scene,{targets:[this.sprite,this.amountText],scale:"*=1.5",alpha:0,ease:"Sine.Ease.In",duration:150});const e=this.scene.chubriks.indexOf(this);this.scene.chubriks.splice(e,1),this.sprite.destroy(),this.amountText.destroy(),this.scene.add.image(this.x,this.y,b.Key,C.getBodyFrame(this.config.type))}))}drawRange(e=4){const{col:t,row:i}=this.scene.getLogicPosition(this.x,this.y);this.rangeArray.push(this.scene.add.rectangle(this.x,this.y,this.scene.cellSize,this.scene.cellSize,11459242,.75));for(let a=i-e;a<=i+e;a++)for(let r=t-e;r<=t+e;r++)if(this.scene.isValid(r,a)&&(r-t)*(r-t)+(a-i)*(a-i)<e*e){if(this.scene.getChubrik(r,a))continue;const e=this.scene.getWorldPosition(r,a),t=this.scene.add.rectangle(e.x,e.y,this.scene.cellSize,this.scene.cellSize,11322842,.25);this.rangeArray.push(t)}}clearRange(){this.rangeArray.forEach((e=>e.destroy()))}static getFrame(e){return"fire_chubrik"===e?b.chubrik1:"water_chubrik"===e?b["water_chubrik (1)"]:"earth_chubrik"===e?b["earth_chubrik (1)"]:"air_chubrik"===e?b["air_chubrik (1)"]:"dragon"===e?b["dragon (1)"]:"water_dragon"===e?b["water_dragon (1)"]:"earth_bender"===e?b["earth_bender (1)"]:"air_bird"===e?b["bird (1)"]:"skeleton"===e?b["skeleton (1)"]:"chertik"===e?b["chertik (1)"]:"air_mage"===e?b["air_mage (1)"]:b.blood}static getScale(e){return"fire_chubrik"===e?.15:"water_chubrik"===e||"earth_chubrik"===e||"air_chubrik"===e||"dragon"===e||"water_dragon"===e||"skeleton"===e||"chertik"===e||"air_bird"===e||"earth_bender"===e?.2:1}static getAnim(e){return"fire_chubrik"===e?"fire_chubrik":"water_chubrik"===e?"water_chubrik":"earth_chubrik"===e?"earth_chubrik":"air_chubrik"===e?"air_chubrik":"dragon"===e?"dragon":"water_dragon"===e?"water_dragon":"earth_bender"===e?"earth_bender":"air_bird"===e?"air_bird":"skeleton"===e?"skeleton":"chertik"===e?"chertik":"air_mage"===e?"air_mage":b.blood}static getBodyFrame(e){return"earth_chubrik"===e?b.earth_chubrik_body:"water_chubrik"===e?b.water_chubrik_body:b.earth_chubrik_body}}class B{static get Instance(){return this._instance||(this._instance=new B),this._instance}}class M extends w{constructor(){super("ArmyScene"),M.instance=this,window.ArmyScene=this}create(){this.camera.setBackgroundColor("#212C36"),this.config=this.cache.json.get("Chubriks"),this.gold=5e3,this.initSlots(),this.initChubriks(),this.initGold(),this.initDoneBtn(),this.initCloseBtn(),this.add.image(0,0,k.lightmap).setAlpha(.25),this.add.image(0,0,k.lightBg).setAlpha(.25),this.emitters=[],this.emitters.push(this.add.particles(0,0,k.particle1,{alpha:{start:1,end:0},scale:{start:.5,end:2.5},tint:{start:16749662,end:16749662},speed:20,accelerationY:-300,angle:{min:-85,max:-95},rotate:{min:-180,max:180},lifespan:{min:1e3,max:1100},blendMode:"ADD",frequency:110}).setPosition(.5*this.camera.width-30,.5*this.camera.height-50)),this.emitters.push(this.add.particles(0,0,k.particle1,{alpha:{start:1,end:0},scale:{start:.5,end:2.5},tint:{start:16749662,end:16749662},speed:20,accelerationY:-300,angle:{min:-85,max:-95},rotate:{min:-180,max:180},lifespan:{min:1e3,max:1100},blendMode:"ADD",frequency:110}).setPosition(.5*-this.camera.width+30,.5*this.camera.height-50)),this.show(),this.initResize()}initChubriks(){const e=this.config.map((e=>{const t=C.createSprite(this,e.type).setInteractive({cursor:"hand"});return v(t).on("click",(()=>{this.scene.launch("PurchaseScene",e)})),t}));S.AsGrid(e,2,8,10)}initSlots(){this.slots=[];for(let e=0;e<7;e++){const e=this.add.rectangle(0,0,48,48,0,1).setAlpha(.6).setStrokeStyle(2,16777215);this.slots.push({rect:e,chubrik:null,image:null,text:null})}S.AsRow(this.slots.map((e=>e.rect)),0,0,.5*this.view.height-40)}initGold(){this.goldText=this.add.bitmapText(0,.5*-this.view.height+30,"nokia16",this.gold.toString()).setOrigin(.5).setCenterAlign(),this.goldIcon=this.add.image(this.goldText.getRightCenter().x,this.goldText.y,b.Key,b.coin).setOrigin(0,.5)}initCloseBtn(){const e=this.add.image(0,0,b.Key,b.cross).setScale(.5).setInteractive({cursor:"hand"});v(e).on("click",(()=>{this.scene.stop(),this.scene.start("MenuScene")})),e.setPosition(.5*this.gameWidth-32,.5*-this.gameHeight+32)}initDoneBtn(){const e=this.add.bitmapText(this.slots[this.slots.length-1].rect.x+100,.5*this.view.height-40,"nokia16","Done").setOrigin(.5).setCenterAlign().setFontSize(24);v(e),e.setInteractive().on("click",(()=>{this.tweens.getTweensOf(e).length>0||this.tweens.add({targets:e,scale:"*=0.8",ease:"Sine.easeIn",duration:125,yoyo:!0,onStart:()=>{this.slots.filter((e=>null==e.chubrik)).length!==this.slots.length&&(null!=B.Instance.playerA?(B.Instance.playerB={slots:this.slots.map((e=>e.chubrik))},this.scene.start("GameScene")):(B.Instance.playerA={slots:this.slots.map((e=>e.chubrik))},this.scene.restart()))}})}))}onPurchased(e){const{type:t,amount:i,price:a}=e;if(i<=0)return;const r=this.slots.find((e=>e.chubrik&&e.chubrik.type==t)),n=this.slots.find((e=>null==e.chubrik)),s=null!=r?r:n;s||console.error("no empty slot"),s&&(s.chubrik?s.chubrik.amount+=i:(s.chubrik=e,s.image=C.createSprite(this,t).setPosition(s.rect.x,s.rect.y),s.text=this.add.bitmapText(s.rect.x,s.rect.y+30,"nokia16").setOrigin(.5).setCenterAlign().setDepth(2)),s.text.setText(s.chubrik.amount.toString()),this.gold-=a,this.goldText.setText(this.gold.toString()))}onResize(){this.camera.centerOn(0,0)}}const O=(e,t,i)=>((e-t)%(i-t)+(i-t))%(i-t)+t;window.wrap=O;class T extends w{constructor(){super("GameScene"),T.instance=this,window.GameScene=this}create(){window.game=this,this.camera.setBackgroundColor("#212C36"),this.config=this.cache.json.get("Chubriks"),this.createBloodEmitter(),this.createGrid();const e=B.Instance;e.playerA&&e.playerB?(console.log(e),console.log(e),this.chubriks=[...e.playerA.slots.filter((e=>e)).map(((e,t)=>new C(this,0,t,this.config.find((t=>t.type===e.type)),e.amount))),...e.playerB.slots.filter((e=>e)).map(((e,t)=>new C(this,15,t,this.config.find((t=>t.type===e.type)),e.amount)))]):this.chubriks=[new C(this,0,0,this.config.find((e=>"fire_chubrik"===e.type)),100),new C(this,15,9,this.config.find((e=>"fire_chubrik"===e.type)),400)],this.currentChubrik=this.chubriks[0],this.currentChubrik.drawRange(),this.add.image(.5*-this.gameWidth+50,-100,b.Key,b.air_hero).setScale(.35),this.hero1=this.add.image(.5*this.gameWidth-50,-100,b.Key,b.air_hero).setScale(.35).setFlipX(!0).setTint(15419186),this.spellBook=this.add.image(.5*-this.gameWidth+25,150,b.Key,b.spellbook).setAlpha(.5).setInteractive().on("pointerdown",(()=>{let e=1===this.spellBook.alpha;this.spellBook.alpha=e?.5:1,this.spellActive=!e,this.scene.launch("SpellbookScene")})),this.input.on("pointerdown",this.onClick,this),this.initResize()}createGrid(){this.cols=16,this.rows=10,this.cellSize=32,this.width=this.cols*this.cellSize,this.height=this.rows*this.cellSize;for(let e=0;e<this.rows;e++)for(let t=0;t<this.cols;t++){const i=this.getWorldPosition(t,e),a=this.add.rectangle(i.x,i.y,this.cellSize,this.cellSize,65280,.25);a.setStrokeStyle(2,8621192,.25),a.isStroked=!0;const r=Phaser.Math.RND.pick([b.grass1,b.grass2,b.grass3,b.grass4]);this.add.image(i.x,i.y,b.Key,r),Phaser.Math.Between(0,100)<3&&this.add.image(i.x,i.y,b.Key,Phaser.Math.RND.pick([b.luzha,b.stone])).setDepth(1)}}createBloodEmitter(){this.bloodParticle=this.add.particles(0,0,b.Key,{frame:b.blood,speedX:{random:[16,48]},speedY:{random:[8,48]},lifespan:{random:[500,1e3]},scale:.2,alpha:{start:1,end:0},tint:16634865,quantity:2,frequency:100}).stop().setDepth(12)}onClick(e){return t=this,i=void 0,r=function*(){const t=e.worldX,i=e.worldY,a=this.getLogicPosition(this.currentChubrik.x,this.currentChubrik.y),r=this.getLogicPosition(t,i),n=this.getWorldPosition(r.col,r.row);if(!this.isValid(r.col,r.row))return;console.log("onclick: ",t,i,r);const s=this.getChubrik(r.col,r.row);if(s!==this.currentChubrik){if(s){if(this.spellActive){const e=this.add.rectangle(0,0,this.gameWidth,this.gameHeight,0,1).setAlpha(0).setDepth(30);yield A(this,{targets:e,alpha:.3,duration:200});const t=this.add.sprite(s.x,s.y,b.Key,b["lightning (1)"]).play("lightning").setScale(.5).setDepth(30);return yield this.waitFor(500),s.takeDamage(10),yield A(this,{targets:e,alpha:0,duration:200}),t.destroy(),e.destroy(),this.spellActive=!1,void(this.spellBook.alpha=.5)}return this.input.enabled=!1,yield this.currentChubrik.attackAction(s),void(this.input.enabled=!0)}this.isRangeValid(a.col,a.row,r.col,r.row)&&(this.input.enabled=!1,yield this.currentChubrik.moveAction(n),this.onMoveEnd(),this.input.enabled=!0)}},new((a=void 0)||(a=Promise))((function(e,n){function s(e){try{l(r.next(e))}catch(e){n(e)}}function o(e){try{l(r.throw(e))}catch(e){n(e)}}function l(t){var i;t.done?e(t.value):(i=t.value,i instanceof a?i:new a((function(e){e(i)}))).then(s,o)}l((r=r.apply(t,i||[])).next())}));var t,i,a,r}isRangeValid(e,t,i,a,r=4){const n=e-i,s=t-a;return n*n+s*s<r*r}onMoveEnd(){const e=this.chubriks,t=e.indexOf(this.currentChubrik),i=O(t+1,0,e.length);this.currentChubrik=e[i],this.currentChubrik.drawRange()}isInRange(e,t,i=4){return e*e+t*t<i*i}getChubrik(e,t){const i=this.chubriks,a=this.getWorldPosition(e,t);return i.find((e=>e.x==a.x&&e.y==a.y))}isValid(e,t){return!(e<0||e>=this.cols||t<0||t>=this.rows)}getWorldPosition(e,t){return{x:Math.floor(e*this.cellSize-.5*this.width+.5*this.cellSize),y:Math.floor(t*this.cellSize-.5*this.height+.5*this.cellSize)}}getLogicPosition(e,t){return{col:Math.floor((e+.5*this.width)/this.cellSize),row:Math.floor((t+.5*this.height)/this.cellSize)}}onResize(){this.camera.centerOn(0,0)}}var W=function(e,t,i,a){return new(i||(i=Promise))((function(r,n){function s(e){try{l(a.next(e))}catch(e){n(e)}}function o(e){try{l(a.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,o)}l((a=a.apply(e,t||[])).next())}))};class D extends w{constructor(){super("MenuScene"),D.instance=this,window.MenuScene=this}create(){this.camera.setBackgroundColor("#353535"),this.add.bitmapText(0,-100,"nokia16","HOMM 10").setOrigin(.5).setCenterAlign().setFontSize(30);const e=this.add.bitmapText(0,-100,"nokia16","Play").setOrigin(.5).setCenterAlign().setFontSize(26);e.setInteractive({cursor:"hand"}),v(e).on("click",(()=>W(this,void 0,void 0,(function*(){console.log("START GAME"),this.input.enabled=!1,yield this.btnTween(e),this.scene.start("GameScene"),this.scene.stop()}))));const t=this.add.bitmapText(0,-100,"nokia16","Versus").setOrigin(.5).setCenterAlign().setFontSize(26);t.setInteractive({cursor:"hand"}),v(t).on("click",(()=>W(this,void 0,void 0,(function*(){console.log("START ARMY"),this.input.enabled=!1,yield this.btnTween(t),this.scene.start("ArmyScene"),this.scene.stop()})))),S.AsColumn([e,t],20),this.add.image(0,0,k.lightmap).setAlpha(.25),this.add.image(0,0,k.lightBg).setAlpha(.25),this.emitters=[],this.emitters.push(this.add.particles(0,0,k.particle1,{frame:[b.particle1,b.particle2],alpha:{start:1,end:0},scale:{start:.5,end:2.5},tint:{start:16749662,end:16749662},speed:20,accelerationY:-300,angle:{min:-85,max:-95},rotate:{min:-180,max:180},lifespan:{min:1e3,max:1100},blendMode:"ADD",frequency:110}).setPosition(.5*this.camera.width-100,.5*this.camera.height-50)),this.emitters.push(this.add.particles(0,0,k.particle1,{alpha:{start:1,end:0},scale:{start:.5,end:2.5},tint:{start:16749662,end:16749662},speed:20,accelerationY:-300,angle:{min:-85,max:-95},rotate:{min:-180,max:180},lifespan:{min:1e3,max:1100},blendMode:"ADD",frequency:110}).setPosition(.5*-this.camera.width+100,.5*this.camera.height-50)),this.show(),this.initResize()}btnTween(e){return W(this,void 0,void 0,(function*(){yield A(this,{targets:e,scale:{from:1,to:1.1},yoyo:!0,duration:125})}))}onResize(){this.camera.centerOn(0,0)}}class R extends Phaser.Scene{constructor(){super({key:"PreloadScene"})}preload(){Object.entries(m).forEach((e=>{const t=e[0],i=e[1];this.load.image(t,i)})),Object.entries(_).forEach((e=>{const t=e[0],i=e[1];this.load.atlas(t,`assets/atlases/${i.image}`,`assets/atlases/${i.json}`)})),Object.entries(u).forEach((e=>{const t=e[0],i=e[1];this.load.audio(t,i)})),Object.entries(g).forEach((e=>{const t=e[0],i=e[1];this.load.json(t,i)})),this.load.bitmapFont("nokia16","assets/fonts/bitmapFonts/nokia16.png","assets/fonts/bitmapFonts/nokia16.xml")}create(){this.createAnims(),this.scene.start("MenuScene")}createAnims(){this.anims.create({key:"fire_chubrik",frames:this.anims.generateFrameNames(b.Key,{start:1,end:4,prefix:"fire_chubrik (",suffix:")"}),skipMissedFrames:!0,repeat:-1,frameRate:12}),this.anims.create({key:"water_chubrik",frames:this.anims.generateFrameNames(b.Key,{start:1,end:4,prefix:"water_chubrik (",suffix:")"}),skipMissedFrames:!0,repeat:-1,frameRate:12}),this.anims.create({key:"earth_chubrik",frames:this.anims.generateFrameNames(b.Key,{start:1,end:4,prefix:"earth_chubrik (",suffix:")"}),skipMissedFrames:!0,repeat:-1,frameRate:12}),this.anims.create({key:"air_chubrik",frames:this.anims.generateFrameNames(b.Key,{start:1,end:4,prefix:"air_chubrik (",suffix:")"}),skipMissedFrames:!0,repeat:-1,frameRate:12}),this.anims.create({key:"dragon",frames:this.anims.generateFrameNames(b.Key,{start:1,end:4,prefix:"dragon (",suffix:")"}),skipMissedFrames:!0,repeat:-1,frameRate:12}),this.anims.create({key:"water_dragon",frames:this.anims.generateFrameNames(b.Key,{start:1,end:4,prefix:"water_dragon (",suffix:")"}),skipMissedFrames:!0,repeat:-1,frameRate:12}),this.anims.create({key:"earth_bender",frames:this.anims.generateFrameNames(b.Key,{start:1,end:4,prefix:"earth_bender (",suffix:")"}),skipMissedFrames:!0,repeat:-1,frameRate:12}),this.anims.create({key:"bird",frames:this.anims.generateFrameNames(b.Key,{start:1,end:4,prefix:"bird (",suffix:")"}),skipMissedFrames:!0,repeat:-1,frameRate:12}),this.anims.create({key:"skeleton",frames:this.anims.generateFrameNames(b.Key,{start:1,end:4,prefix:"skeleton (",suffix:")"}),skipMissedFrames:!0,repeat:-1,frameRate:12}),this.anims.create({key:"chertik",frames:this.anims.generateFrameNames(b.Key,{start:1,end:4,prefix:"chertik (",suffix:")"}),skipMissedFrames:!0,repeat:-1,frameRate:12}),this.anims.create({key:"air_mage",frames:this.anims.generateFrameNames(b.Key,{start:1,end:4,prefix:"air_mage (",suffix:")"}),skipMissedFrames:!0,repeat:-1,frameRate:12}),this.anims.create({key:"air_chubrik_patron",frames:this.anims.generateFrameNames(b.Key,{start:1,end:5,prefix:"air_chubrik_patron (",suffix:")"}),skipMissedFrames:!0,repeat:-1,frameRate:12}),this.anims.create({key:"fire_chubrik_patron",frames:this.anims.generateFrameNames(b.Key,{start:1,end:5,prefix:"fire_chubrik_patron (",suffix:")"}),skipMissedFrames:!0,repeat:-1,frameRate:12}),this.anims.create({key:"lightning",frames:this.anims.generateFrameNames(b.Key,{start:1,end:10,prefix:"lightning (",suffix:")"}),skipMissedFrames:!0,frameRate:12})}}class z extends w{constructor(){super("PurchaseScene"),z.instance=this,window.PurchaseScene=this}create(e){this.config=e,this.add.rectangle(0,0,this.gameWidth,this.gameHeight,0,.8).setInteractive(),this.background=this.add.rectangle(0,0,256,256,0,.95);const t=C.createSprite(this,e.type),i=this.add.container(0,0,[this.add.bitmapText(0,0,"nokia16",`life: ${e.life}`).setLeftAlign(),this.add.bitmapText(0,0,"nokia16",`attack: ${e.attack}`).setLeftAlign(),this.add.bitmapText(0,0,"nokia16",`defense: ${e.defense}`).setLeftAlign(),this.add.bitmapText(0,0,"nokia16",`range: ${e.range}`).setLeftAlign(),this.add.bitmapText(0,0,"nokia16",`speed: ${e.speed}`).setLeftAlign(),this.add.bitmapText(0,0,"nokia16",`price: ${e.price}`).setLeftAlign()]),a=this.add.image(0,0,b.Key,b.cross).setScale(.5).setInteractive();v(a).on("click",(()=>{this.close()})),a.setPosition(.5*this.gameWidth-64,.5*-this.gameHeight+64),this.pbBar=this.add.image(0,0,b.Key,b.pb_back),this.pbHandle=this.add.image(0,0,b.Key,b.pb_handle).setOrigin(0,.5),this.pbText=this.add.bitmapText(0,0,"nokia16","0").setOrigin(.5).setCenterAlign(),this.pbMin=this.pbBar.getLeftCenter().x,this.pbMax=this.pbBar.getRightCenter().x-.5*this.pbHandle.width,this.goldText=this.add.bitmapText(0,0,"nokia16","0").setOrigin(.5).setCenterAlign().setFontSize(24),this.goldIcon=this.add.image(0,0,b.Key,b.coin).setOrigin(0,.5).setScale(.7),this.buyBtn=this.add.bitmapText(0,0,"nokia16","buy").setOrigin(.5).setCenterAlign().setFontSize(24),S.AsColumn(i.list,10),S.AsRow([t,i],64),S.AsRow([this.goldText,this.goldIcon,this.buyBtn],[0,40],0,this.background.getBottomCenter().y-20),i.y-=30,t.y-=30,t.x+=15,this.pbBar.y=this.background.getBottomCenter().y-60,this.pbHandle.y=this.background.getBottomCenter().y-60,this.pbHandle.x=this.pbMin,this.pbText.setPosition(0,this.pbBar.getBottomCenter().y),this.pbBar.setInteractive().on("pointerdown",(()=>{this.pbHandle.setData("pointerdown",!0)})),this.pbHandle.setInteractive().on("pointerdown",(()=>{this.pbHandle.setData("pointerdown",!0)})),this.input.on("pointerup",(()=>this.pbHandle.setData("pointerdown",!1))),v(this.buyBtn),this.buyBtn.setInteractive().on("click",(()=>{this.tweens.getTweensOf(this.buyBtn).length>0||this.tweens.add({targets:this.buyBtn,scale:"*=0.8",ease:"Sine.easeIn",duration:125,yoyo:!0,onStart:()=>{this.price>M.instance.gold||(this.close(),M.instance.onPurchased({type:e.type,amount:this.amount,price:this.price}))}})})),this.show(),this.initResize()}close(){this.scene.stop()}update(e,t){const i=this.input.activePointer;i.isDown&&this.pbHandle.getData("pointerdown")&&(i.updateWorldPoint(this.camera),this.pbBar.getRightCenter().x,this.pbHandle.width,this.pbHandle.x=Phaser.Math.Clamp(i.worldX,this.pbMin,this.pbMax),this.pbText.setText(this.amount.toFixed(0)),this.goldText.setText(this.price.toString()),S.AsRow([this.goldText,this.goldIcon,this.buyBtn],[0,40],0,this.background.getBottomCenter().y-20),this.price>M.instance.gold?this.goldText.setTint(16711680):this.goldText.clearTint())}get progress(){return(this.pbHandle.x-this.pbMin)/(this.pbMax-this.pbMin)}get amount(){return Math.floor(100*this.progress)}get price(){return this.config.price*this.amount}onResize(){this.camera.centerOn(0,0)}}class F extends w{constructor(){super("SpellbookScene"),F.instance=this,window.SpellbookScene=this}create(e){this.config=e,this.background=this.add.rectangle(0,0,300,300,3815994,.95);const t=[];for(let e=0;e<16;e++)t.push({rect:this.add.rectangle(0,0,48,48,0,1)});S.AsGrid(t.map((e=>e.rect)),4,4,20,20),this.show(),this.initResize()}close(){this.scene.stop()}update(e,t){}onResize(){this.camera.centerOn(0,0)}}const E=[R,D,T,M,z,F];var I=i(242);document.body.style.overflow="hidden";const j=720,K=360,N=1e3,X={scene:E,type:Phaser.AUTO,backgroundColor:"#353535",canvas:document.getElementsByTagName("canvas")[0],scale:{parent:"phaser-game",mode:Phaser.Scale.NONE,width:j,height:K},physics:{default:"matter",matter:{debug:!1,gravity:{x:0,y:0}}},plugins:{global:[I.Plugin.DefaultCfg]},render:{clearBeforeRender:!0,roundPixels:!0,antialiasGL:!1,pixelArt:!1,powerPreference:"high-performance"}};window.addEventListener("load",(()=>{const e=new Phaser.Game(X),t=()=>{const t=window.innerWidth,i=window.innerHeight;let a=j,r=K,n=N,s=361;t<i?(a=K,r=j,n=361,s=N):(a=j,r=K,n=N,s=361);let o=Math.min(t/a,i/r),l=Math.min(t/o,n),c=Math.min(i/o,s),h=1;e.scale.resize(l*h,c*h),e.canvas.style.width=l*o+"px",e.canvas.style.height=c*o+"px",e.canvas.style.marginTop=(i-c*o)/2+"px",e.canvas.style.marginLeft=(t-l*o)/2+"px"};window.addEventListener("resize",(e=>{t()})),t()})),window.Phaser=Phaser},204:()=>{console.log("%c %c %c %c %c Built using phaser-project-template %c https://github.com/yandeu/phaser-project-template","background: #ff0000","background: #ffff00","background: #00ff00","background: #00ffff","color: #fff; background: #000000;","background: none")}},i={};function a(e){var r=i[e];if(void 0!==r)return r.exports;var n=i[e]={exports:{}};return t[e].call(n.exports,n,n.exports,a),n.exports}a.m=t,e=[],a.O=(t,i,r,n)=>{if(!i){var s=1/0;for(h=0;h<e.length;h++){for(var[i,r,n]=e[h],o=!0,l=0;l<i.length;l++)(!1&n||s>=n)&&Object.keys(a.O).every((e=>a.O[e](i[l])))?i.splice(l--,1):(o=!1,n<s&&(s=n));if(o){e.splice(h--,1);var c=r();void 0!==c&&(t=c)}}return t}n=n||0;for(var h=e.length;h>0&&e[h-1][2]>n;h--)e[h]=e[h-1];e[h]=[i,r,n]},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={179:0};a.O.j=t=>0===e[t];var t=(t,i)=>{var r,n,[s,o,l]=i,c=0;if(s.some((t=>0!==e[t]))){for(r in o)a.o(o,r)&&(a.m[r]=o[r]);if(l)var h=l(a)}for(t&&t(i);c<s.length;c++)n=s[c],a.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return a.O(h)},i=self.webpackChunkphaser_project_template=self.webpackChunkphaser_project_template||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})(),a.O(void 0,[216],(()=>a(40)));var r=a.O(void 0,[216],(()=>a(204)));r=a.O(r)})();